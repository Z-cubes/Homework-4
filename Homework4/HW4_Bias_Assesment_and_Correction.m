% NOTE: HW4_Data_Downloading_and_PreProcessing.m must be run first
%       EVERYTIME!
run("HW4_Data_Downloading_and_PreProcessing.m");

% Bias_Assesment_and_Correction (Temperature)

% Calculate 1961to2005_Longterm Mean Temperature 
    % Historical 1961 to 2005       
Observed_1961to2005_Longterm_Mean_Temperature = ...
    mean(Observed_Yearly_1961to2005_Mean_Temperature_Data); % K

    % Control Periods 1961 - 2005
China_Model_1961to2005_Longterm_Mean_Temperature = ...
    mean(China_Model_Yearly_1961to2005_Mean_Temperature_Data); % K
France_Model_1961to2005_Longterm_Mean_Temperature = ...
    mean(France_Model_Yearly_1961to2005_Mean_Temperature_Data); % K
Russia_Model_1961to2005_Longterm_Mean_Temperature = ...
    mean(Russia_Model_Yearly_1961to2005_Mean_Temperature_Data); % K
 Japan_Model_1961to2005_Longterm_Mean_Temperature = ...
    mean(China_Model_Yearly_1961to2005_Mean_Temperature_Data); % K
Norway_Model_1961to2005_Longterm_Mean_Temperature = ...
    mean(Norway_Model_Yearly_1961to2005_Mean_Temperature_Data); % K
    
    % Future 2006 to 2050
China_Model_2006to2050_Longterm_Mean_Temperature = ...
    mean(China_Model_Yearly_2006to2050_Mean_Temperature_Data); % K
France_Model_2006to2050_Longterm_Mean_Temperature = ...
    mean(France_Model_Yearly_2006to2050_Mean_Temperature_Data); % K
Russia_Model_2006to2050_Longterm_Mean_Temperature = ...
    mean(Russia_Model_Yearly_2006to2050_Mean_Temperature_Data); % K
 Japan_Model_2006to2050_Longterm_Mean_Temperature = ...
    mean(China_Model_Yearly_2006to2050_Mean_Temperature_Data); % K
Norway_Model_2006to2050_Longterm_Mean_Temperature = ...
    mean(Norway_Model_Yearly_2006to2050_Mean_Temperature_Data); % K

    % Future 2051 to 2095        
China_Model_2051to2095_Longterm_Mean_Temperature = ...
    mean(China_Model_Yearly_2051to2095_Mean_Temperature_Data); % K
France_Model_2051to2095_Longterm_Mean_Temperature = ...
    mean(France_Model_Yearly_2051to2095_Mean_Temperature_Data); % K
Russia_Model_2051to2095_Longterm_Mean_Temperature = ...
    mean(Russia_Model_Yearly_2051to2095_Mean_Temperature_Data); % K
 Japan_Model_2051to2095_Longterm_Mean_Temperature = ...
    mean(China_Model_Yearly_2051to2095_Mean_Temperature_Data); % K
Norway_Model_2051to2095_Longterm_Mean_Temperature = ...
    mean(Norway_Model_Yearly_2051to2095_Mean_Temperature_Data); % K

% Caculate 1961to2005_Longterm Standard Deviation of Temperature
    % Historical 1961 to 2005        
Observed_1961to2005_Longterm_SD_Temperature = ...
    std(Observed_Yearly_1961to2005_Mean_Temperature_Data); % K

    % Control Period 1961 to 2005
China_Model_1961to2005_Longterm_SD_Temperature = ...
    std(China_Model_Yearly_1961to2005_Mean_Temperature_Data); % K
France_Model_1961to2005_Longterm_SD_Temperature = ...
    std(France_Model_Yearly_1961to2005_Mean_Temperature_Data); % K
Russia_Model_1961to2005_Longterm_SD_Temperature = ...
    std(Russia_Model_Yearly_1961to2005_Mean_Temperature_Data); % K
 Japan_Model_1961to2005_Longterm_SD_Temperature = ...
    std(China_Model_Yearly_1961to2005_Mean_Temperature_Data); % K
Norway_Model_1961to2005_Longterm_SD_Temperature = ...
    std(Norway_Model_Yearly_1961to2005_Mean_Temperature_Data); % K

    % Future 2006 to 2050        
China_Model_2006to2050_Longterm_SD_Temperature = ...
    mean(China_Model_Yearly_2006to2050_Mean_Temperature_Data); % K
France_Model_2006to2050_Longterm_SD_Temperature = ...
    mean(France_Model_Yearly_2006to2050_Mean_Temperature_Data); % K
Russia_Model_2006to2050_Longterm_SD_Temperature = ...
    mean(Russia_Model_Yearly_2006to2050_Mean_Temperature_Data); % K
 Japan_Model_2006to2050_Longterm_SD_Temperature = ...
    mean(China_Model_Yearly_2006to2050_Mean_Temperature_Data); % K
Norway_Model_2006to2050_Longterm_SD_Temperature = ...
    mean(Norway_Model_Yearly_2006to2050_Mean_Temperature_Data); % K

    % Future 2051 to 2095        
China_Model_2051to2095_Longterm_SD_Temperature = ...
    mean(China_Model_Yearly_2051to2095_Mean_Temperature_Data); % K
France_Model_2051to2095_Longterm_SD_Temperature = ...
    mean(France_Model_Yearly_2051to2095_Mean_Temperature_Data); % K
Russia_Model_2051to2095_Longterm_SD_Temperature = ...
    mean(Russia_Model_Yearly_2051to2095_Mean_Temperature_Data); % K
 Japan_Model_2051to2095_Longterm_SD_Temperature = ...
    mean(China_Model_Yearly_2051to2095_Mean_Temperature_Data); % K
Norway_Model_2051to2095_Longterm_SD_Temperature = ...
    mean(Norway_Model_Yearly_2051to2095_Mean_Temperature_Data); % K

% Compute Bias Difference 
    % Control Period 1961 to 2005 
China_Model_Bias_diff_T = Observed_1961to2005_Longterm_Mean_Temperature ...
    - China_Model_1961to2005_Longterm_Mean_Temperature;
France_Model_Bias_diff_T = Observed_1961to2005_Longterm_Mean_Temperature ...
    - France_Model_1961to2005_Longterm_Mean_Temperature;
Russia_Model_Bias_diff_T = Observed_1961to2005_Longterm_Mean_Temperature ...
    - Russia_Model_1961to2005_Longterm_Mean_Temperature;
Japan_Model_Bias_diff_T = Observed_1961to2005_Longterm_Mean_Temperature ...
    - Japan_Model_1961to2005_Longterm_Mean_Temperature;
Norway_Model_Bias_diff_T = Observed_1961to2005_Longterm_Mean_Temperature ...
    - Norway_Model_1961to2005_Longterm_Mean_Temperature;

% Compute Comparitive Bias Ratio 
    % Control Period 1961 to 2005
China_Model_Bias_ratio_T = Observed_1961to2005_Longterm_Mean_Temperature ...
    / China_Model_1961to2005_Longterm_Mean_Temperature;
France_Model_Bias_ratio_T = Observed_1961to2005_Longterm_Mean_Temperature ...
    / France_Model_1961to2005_Longterm_Mean_Temperature;
Russia_Model_Bias_ratio_T = Observed_1961to2005_Longterm_Mean_Temperature ...
    / Russia_Model_1961to2005_Longterm_Mean_Temperature;
Japan_Model_Bias_ratio_T = Observed_1961to2005_Longterm_Mean_Temperature ...
    / Japan_Model_1961to2005_Longterm_Mean_Temperature;
Norway_Model_Bias_ratio_T = Observed_1961to2005_Longterm_Mean_Temperature ...
    / Norway_Model_1961to2005_Longterm_Mean_Temperature;

% Compute the the temperture anomaly series, 
for t = 1:45
    % Control Period 1961 - 2005
    China_Model_1961to2005_Temperature_Anomaly_Series(t) = ...
        (China_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - China_Model_1961to2005_Longterm_Mean_Temperature) ...
         / China_Model_1961to2005_Longterm_SD_Temperature;
    France_Model_1961to2005_Temperature_Anomaly_Series(t) = ...
        (France_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - France_Model_1961to2005_Longterm_Mean_Temperature) ...
         / France_Model_1961to2005_Longterm_SD_Temperature;
    Russia_Model_1961to2005_Temperature_Anomaly_Series(t) = ...
        (Russia_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - Russia_Model_1961to2005_Longterm_Mean_Temperature) ...
         / Russia_Model_1961to2005_Longterm_SD_Temperature;
    Japan_Model_1961to2005_Temperature_Anomaly_Series(t) = ...
        (Japan_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - Japan_Model_1961to2005_Longterm_Mean_Temperature) ...
         / Japan_Model_1961to2005_Longterm_SD_Temperature;
    Norway_Model_1961to2005_Temperature_Anomaly_Series(t) = ...
        (Norway_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - Norway_Model_1961to2005_Longterm_Mean_Temperature) ...
         / Norway_Model_1961to2005_Longterm_SD_Temperature;
    
    % Future 2006 to 2050
    China_Model_2006to2050_Temperature_Anomaly_Series(t) = ...
        (China_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - China_Model_2006to2050_Longterm_Mean_Temperature) ...
         / China_Model_2006to2050_Longterm_SD_Temperature;
    France_Model_2006to2050_Temperature_Anomaly_Series(t) = ...
        (France_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - France_Model_2006to2050_Longterm_Mean_Temperature) ...
         / France_Model_2006to2050_Longterm_SD_Temperature;
    Russia_Model_2006to2050_Temperature_Anomaly_Series(t) = ...
        (Russia_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - Russia_Model_2006to2050_Longterm_Mean_Temperature) ...
         / Russia_Model_2006to2050_Longterm_SD_Temperature;
    Japan_Model_2006to2050_Temperature_Anomaly_Series(t) = ...
        (Japan_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - Japan_Model_2006to2050_Longterm_Mean_Temperature) ...
         / Japan_Model_2006to2050_Longterm_SD_Temperature;
    Norway_Model_2006to2050_Temperature_Anomaly_Series(t) = ...
        (Norway_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - Norway_Model_2006to2050_Longterm_Mean_Temperature) ...
         / Norway_Model_2006to2050_Longterm_SD_Temperature;
   
    % Future 2051 to 2095
    China_Model_2051to2095_Temperature_Anomaly_Series(t) = ...
        (China_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - China_Model_2051to2095_Longterm_Mean_Temperature) ...
         / China_Model_2051to2095_Longterm_SD_Temperature;
    France_Model_2051to2095_Temperature_Anomaly_Series(t) = ...
        (France_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - France_Model_2051to2095_Longterm_Mean_Temperature) ...
         / France_Model_2051to2095_Longterm_SD_Temperature;
    Russia_Model_2051to2095_Temperature_Anomaly_Series(t) = ...
        (Russia_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - Russia_Model_2051to2095_Longterm_Mean_Temperature) ...
         / Russia_Model_2051to2095_Longterm_SD_Temperature;
    Japan_Model_2051to2095_Temperature_Anomaly_Series(t) = ...
        (Japan_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - Japan_Model_2051to2095_Longterm_Mean_Temperature) ...
         / Japan_Model_2051to2095_Longterm_SD_Temperature;
    Norway_Model_2051to2095_Temperature_Anomaly_Series(t) = ...
        (Norway_Model_Yearly_2051to2095_Mean_Temperature_Data(t) ...
        - Norway_Model_2051to2095_Longterm_Mean_Temperature) ...
         / Norway_Model_2051to2095_Longterm_SD_Temperature;
end

% Compute Bias-corrected Temperature series     
for t = 1:45
    % Control Period 1961 to 2005
    if (China_Model_Bias_diff_T <= -1e-3 || China_Model_Bias_diff_T >= 1e-3) ...
        && (China_Model_Bias_ratio_T <= 0.999 || China_Model_Bias_ratio_T >= 1.001)
        China_Model_1961to2005_Temperature_Bias_Corrected(t) = ...
            China_Model_1961to2005_Temperature_Anomaly_Series(t) ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            + Observed_1961to2005_Longterm_Mean_Temperature;
    else
        China_Model_1961to2005_Temperature_Bias_Corrected(t) = 0;
    end
    if (France_Model_Bias_diff_T <= -1e-3 || France_Model_Bias_diff_T >= 1e-3) ...
        && (France_Model_Bias_ratio_T <= 0.999 || France_Model_Bias_ratio_T >= 1.001)
        France_Model_1961to2005_Temperature_Bias_Corrected(t) = ...
            France_Model_1961to2005_Temperature_Anomaly_Series(t) ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            + Observed_1961to2005_Longterm_Mean_Temperature;
    else
        France_Model_1961to2005_Temperature_Bias_Corrected(t) = 0;
    end
    if (Russia_Model_Bias_diff_T <= -1e-3 || Russia_Model_Bias_diff_T >= 1e-3) ...
        && (Russia_Model_Bias_ratio_T <= 0.999 || Russia_Model_Bias_ratio_T >= 1.001)
        Russia_Model_1961to2005_Temperature_Bias_Corrected(t) = ...
            Russia_Model_1961to2005_Temperature_Anomaly_Series(t) ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            + Observed_1961to2005_Longterm_Mean_Temperature;
    else
        Russia_Model_1961to2005_Temperature_Bias_Corrected(t) = 0;
    end
    if (Japan_Model_Bias_diff_T <= -1e-3 || Japan_Model_Bias_diff_T >= 1e-3) ...
        && (Japan_Model_Bias_ratio_T <= 0.999 || Japan_Model_Bias_ratio_T >= 1.001)
        Japan_Model_1961to2005_Temperature_Bias_Corrected(t) = ...
            Japan_Model_1961to2005_Temperature_Anomaly_Series(t) ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            + Observed_1961to2005_Longterm_Mean_Temperature;
    else
        Japan_Model_1961to2005_Temperature_Bias_Corrected(t) = 0;
    end
    if (Norway_Model_Bias_diff_T <= -1e-3 || Norway_Model_Bias_diff_T >= 1e-3) ...
        && (Norway_Model_Bias_ratio_T <= 0.999 || Norway_Model_Bias_ratio_T >= 1.001)
        Norway_Model_1961to2005_Temperature_Bias_Corrected(t) = ...
            Norway_Model_1961to2005_Temperature_Anomaly_Series(t) ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            + Observed_1961to2005_Longterm_Mean_Temperature;
    else
        Norway_Model_1961to2005_Temperature_Bias_Corrected(t) = 0;
    end

    % Future 2006 to 2050
    if (China_Model_Bias_diff_T <= -1e-3 || China_Model_Bias_diff_T >= 1e-3) ...
        && (China_Model_Bias_ratio_T <= 0.999 || China_Model_Bias_ratio_T >= 1.001)
        China_Model_2006to2050_Temperature_Bias_Corrected(t) = ...
            China_Model_2006to2050_Temperature_Anomaly_Series(t) ...
            * China_Model_2006to2050_Longterm_SD_Temperature ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            / China_Model_1961to2005_Longterm_SD_Temperature ...
            + China_Model_2006to2050_Longterm_Mean_Temperature ... 
            + (Observed_1961to2005_Longterm_Mean_Temperature ...
            - China_Model_2006to2050_Longterm_Mean_Temperature);
    else
        China_Model_2006to2050_Temperature_Bias_Corrected(t) = 0;
    end
    if (France_Model_Bias_diff_T <= -1e-3 || France_Model_Bias_diff_T >= 1e-3) ...
        && (France_Model_Bias_ratio_T <= 0.999 || France_Model_Bias_ratio_T >= 1.001)
        France_Model_2006to2050_Temperature_Bias_Corrected(t) = ...
            France_Model_2006to2050_Temperature_Anomaly_Series(t) ...
            * France_Model_2006to2050_Longterm_SD_Temperature ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            / France_Model_1961to2005_Longterm_SD_Temperature ...
            + France_Model_2006to2050_Longterm_Mean_Temperature ... 
            + (Observed_1961to2005_Longterm_Mean_Temperature ...
            - France_Model_2006to2050_Longterm_Mean_Temperature);
    else
        France_Model_2006to2050_Temperature_Bias_Corrected(t) = 0;
    end
    if (Russia_Model_Bias_diff_T <= -1e-3 || Russia_Model_Bias_diff_T >= 1e-3) ...
        && (Russia_Model_Bias_ratio_T <= 0.999 || Russia_Model_Bias_ratio_T >= 1.001)
        Russia_Model_2006to2050_Temperature_Bias_Corrected(t) = ...
            Russia_Model_2006to2050_Temperature_Anomaly_Series(t) ...
            * Russia_Model_2006to2050_Longterm_SD_Temperature ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            / Russia_Model_1961to2005_Longterm_SD_Temperature ...
            + Russia_Model_2006to2050_Longterm_Mean_Temperature ... 
            + (Observed_1961to2005_Longterm_Mean_Temperature ...
            - Russia_Model_2006to2050_Longterm_Mean_Temperature);
    else
        Russia_Model_2006to2050_Temperature_Bias_Corrected(t) = 0;
    end
    if (Japan_Model_Bias_diff_T <= -1e-3 || Japan_Model_Bias_diff_T >= 1e-3) ...
        && (Japan_Model_Bias_ratio_T <= 0.999 || Japan_Model_Bias_ratio_T >= 1.001)
        Japan_Model_2006to2050_Temperature_Bias_Corrected(t) = ...
            Japan_Model_2006to2050_Temperature_Anomaly_Series(t) ...
            * Japan_Model_2006to2050_Longterm_SD_Temperature ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            / Japan_Model_1961to2005_Longterm_SD_Temperature ...
            + Japan_Model_2006to2050_Longterm_Mean_Temperature ... 
            + (Observed_1961to2005_Longterm_Mean_Temperature ...
            - Japan_Model_2006to2050_Longterm_Mean_Temperature);
    else
        Japan_Model_2006to2050_Temperature_Bias_Corrected(t) = 0;
    end
    if (Norway_Model_Bias_diff_T <= -1e-3 || Norway_Model_Bias_diff_T >= 1e-3) ...
        && (Norway_Model_Bias_ratio_T <= 0.999 || Norway_Model_Bias_ratio_T >= 1.001)
        Norway_Model_2006to2050_Temperature_Bias_Corrected(t) = ...
            Norway_Model_2006to2050_Temperature_Anomaly_Series(t) ...
            * Norway_Model_2006to2050_Longterm_SD_Temperature ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            / Norway_Model_1961to2005_Longterm_SD_Temperature ...
            + Norway_Model_2006to2050_Longterm_Mean_Temperature ... 
            + (Observed_1961to2005_Longterm_Mean_Temperature ...
            - Norway_Model_2006to2050_Longterm_Mean_Temperature);
    else
        Norway_Model_2006to2050_Temperature_Bias_Corrected(t) = 0;
    end  
    % Future 2051 to 2095
    if (China_Model_Bias_diff_T <= -1e-3 || China_Model_Bias_diff_T >= 1e-3) ...
        && (China_Model_Bias_ratio_T <= 0.999 || China_Model_Bias_ratio_T >= 1.001)
        China_Model_2051to2095_Temperature_Bias_Corrected(t) = ...
            China_Model_2051to2095_Temperature_Anomaly_Series(t) ...
            * China_Model_2051to2095_Longterm_SD_Temperature ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            / China_Model_1961to2005_Longterm_SD_Temperature ...
            + China_Model_2051to2095_Longterm_Mean_Temperature ... 
            + (Observed_1961to2005_Longterm_Mean_Temperature ...
            - China_Model_2051to2095_Longterm_Mean_Temperature);
    else
        China_Model_2051to2095_Temperature_Bias_Corrected(t) = 0;
    end
    if (France_Model_Bias_diff_T <= -1e-3 || France_Model_Bias_diff_T >= 1e-3) ...
        && (France_Model_Bias_ratio_T <= 0.999 || France_Model_Bias_ratio_T >= 1.001)
        France_Model_2051to2095_Temperature_Bias_Corrected(t) = ...
            France_Model_2051to2095_Temperature_Anomaly_Series(t) ...
            * France_Model_2051to2095_Longterm_SD_Temperature ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            / France_Model_1961to2005_Longterm_SD_Temperature ...
            + France_Model_2051to2095_Longterm_Mean_Temperature ... 
            + (Observed_1961to2005_Longterm_Mean_Temperature ...
            - France_Model_2051to2095_Longterm_Mean_Temperature);
    else
        France_Model_2051to2095_Temperature_Bias_Corrected(t) = 0;
    end
    if (Russia_Model_Bias_diff_T <= -1e-3 || Russia_Model_Bias_diff_T >= 1e-3) ...
        && (Russia_Model_Bias_ratio_T <= 0.999 || Russia_Model_Bias_ratio_T >= 1.001)
        Russia_Model_2051to2095_Temperature_Bias_Corrected(t) = ...
            Russia_Model_2051to2095_Temperature_Anomaly_Series(t) ...
            * Russia_Model_2051to2095_Longterm_SD_Temperature ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            / Russia_Model_1961to2005_Longterm_SD_Temperature ...
            + Russia_Model_2051to2095_Longterm_Mean_Temperature ... 
            + (Observed_1961to2005_Longterm_Mean_Temperature ...
            - Russia_Model_2051to2095_Longterm_Mean_Temperature);
    else
        Russia_Model_2051to2095_Temperature_Bias_Corrected(t) = 0;
    end
    if (Japan_Model_Bias_diff_T <= -1e-3 || Japan_Model_Bias_diff_T >= 1e-3) ...
        && (Japan_Model_Bias_ratio_T <= 0.999 || Japan_Model_Bias_ratio_T >= 1.001)
        Japan_Model_2051to2095_Temperature_Bias_Corrected(t) = ...
            Japan_Model_2051to2095_Temperature_Anomaly_Series(t) ...
            * Japan_Model_2051to2095_Longterm_SD_Temperature ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            / Japan_Model_1961to2005_Longterm_SD_Temperature ...
            + Japan_Model_2051to2095_Longterm_Mean_Temperature ... 
            + (Observed_1961to2005_Longterm_Mean_Temperature ...
            - Japan_Model_2051to2095_Longterm_Mean_Temperature);
    else
        Japan_Model_2051to2095_Temperature_Bias_Corrected(t) = 0;
    end
    if (Norway_Model_Bias_diff_T <= -1e-3 || Norway_Model_Bias_diff_T >= 1e-3) ...
        && (Norway_Model_Bias_ratio_T <= 0.999 || Norway_Model_Bias_ratio_T >= 1.001)
        Norway_Model_2051to2095_Temperature_Bias_Corrected(t) = ...
            Norway_Model_2051to2095_Temperature_Anomaly_Series(t) ...
            * Norway_Model_2051to2095_Longterm_SD_Temperature ...
            * Observed_1961to2005_Longterm_SD_Temperature ...
            / Norway_Model_1961to2005_Longterm_SD_Temperature ...
            + Norway_Model_2051to2095_Longterm_Mean_Temperature ... 
            + (Observed_1961to2005_Longterm_Mean_Temperature ...
            - Norway_Model_2051to2095_Longterm_Mean_Temperature);
    else
        Norway_Model_2051to2095_Temperature_Bias_Corrected(t) = 0;
    end
end

%
%
%

% Bias_Assesment_and_Correction (Precipitation)

% Calculate 1961to2005_Longterm Mean Precipitation 
    % Historical 1961 to 2005        
Observed_1961to2005_Longterm_Mean_Precipitation = ...
    mean(Observed_Yearly_1961to2005_Precipitation_Data); % K

    % Control Period 1961 to 2005
China_Model_1961to2005_Longterm_Mean_Precipitation = ...
    mean(China_Model_Yearly_1961to2005_Precipitation_Data); % K
France_Model_1961to2005_Longterm_Mean_Precipitation = ...
    mean(France_Model_Yearly_1961to2005_Precipitation_Data); % K
Russia_Model_1961to2005_Longterm_Mean_Precipitation = ...
    mean(Russia_Model_Yearly_1961to2005_Precipitation_Data); % K
 Japan_Model_1961to2005_Longterm_Mean_Precipitation = ...
    mean(China_Model_Yearly_1961to2005_Precipitation_Data); % K
Norway_Model_1961to2005_Longterm_Mean_Precipitation = ...
    mean(Norway_Model_Yearly_1961to2005_Precipitation_Data); % K
    
    % Future 2006 to 2050      
China_Model_2006to2050_Longterm_Mean_Precipitation = ...
    mean(China_Model_Yearly_2006to2050_Precipitation_Data); % K
France_Model_2006to2050_Longterm_Mean_Precipitation = ...
    mean(France_Model_Yearly_2006to2050_Precipitation_Data); % K
Russia_Model_2006to2050_Longterm_Mean_Precipitation = ...
    mean(Russia_Model_Yearly_2006to2050_Precipitation_Data); % K
 Japan_Model_2006to2050_Longterm_Mean_Precipitation = ...
    mean(China_Model_Yearly_2006to2050_Precipitation_Data); % K
Norway_Model_2006to2050_Longterm_Mean_Precipitation = ...
    mean(Norway_Model_Yearly_2006to2050_Precipitation_Data); % K

    % Future 2051 to 2095        
China_Model_2051to2095_Longterm_Mean_Precipitation = ...
    mean(China_Model_Yearly_2051to2095_Precipitation_Data); % K
France_Model_2051to2095_Longterm_Mean_Precipitation = ...
    mean(France_Model_Yearly_2051to2095_Precipitation_Data); % K
Russia_Model_2051to2095_Longterm_Mean_Precipitation = ...
    mean(Russia_Model_Yearly_2051to2095_Precipitation_Data); % K
 Japan_Model_2051to2095_Longterm_Mean_Precipitation = ...
    mean(China_Model_Yearly_2051to2095_Precipitation_Data); % K
Norway_Model_2051to2095_Longterm_Mean_Precipitation = ...
    mean(Norway_Model_Yearly_2051to2095_Precipitation_Data); % K

% Caculate 1961to2005_Longterm Standard Deviation of Precipitation
    % Historical 1961 to 2005        
Observed_1961to2005_Longterm_SD_Precipitation = ...
    std(Observed_Yearly_1961to2005_Precipitation_Data); % K

    % Control Period 1961 to 2005
China_Model_1961to2005_Longterm_SD_Precipitation = ...
    std(China_Model_Yearly_1961to2005_Precipitation_Data); % K
France_Model_1961to2005_Longterm_SD_Precipitation = ...
    std(France_Model_Yearly_1961to2005_Precipitation_Data); % K
Russia_Model_1961to2005_Longterm_SD_Precipitation = ...
    std(Russia_Model_Yearly_1961to2005_Precipitation_Data); % K
 Japan_Model_1961to2005_Longterm_SD_Precipitation = ...
    std(China_Model_Yearly_1961to2005_Precipitation_Data); % K
Norway_Model_1961to2005_Longterm_SD_Precipitation = ...
    std(Norway_Model_Yearly_1961to2005_Precipitation_Data); % K

    % Future 2006 to 2050        
China_Model_2006to2050_Longterm_SD_Precipitation = ...
    mean(China_Model_Yearly_2006to2050_Precipitation_Data); % K
France_Model_2006to2050_Longterm_SD_Precipitation = ...
    mean(France_Model_Yearly_2006to2050_Precipitation_Data); % K
Russia_Model_2006to2050_Longterm_SD_Precipitation = ...
    mean(Russia_Model_Yearly_2006to2050_Precipitation_Data); % K
 Japan_Model_2006to2050_Longterm_SD_Precipitation = ...
    mean(China_Model_Yearly_2006to2050_Precipitation_Data); % K
Norway_Model_2006to2050_Longterm_SD_Precipitation = ...
    mean(Norway_Model_Yearly_2006to2050_Precipitation_Data); % K

    % Future 2051 to 2095        
China_Model_2051to2095_Longterm_SD_Precipitation = ...
    mean(China_Model_Yearly_2051to2095_Precipitation_Data); % K
France_Model_2051to2095_Longterm_SD_Precipitation = ...
    mean(France_Model_Yearly_2051to2095_Precipitation_Data); % K
Russia_Model_2051to2095_Longterm_SD_Precipitation = ...
    mean(Russia_Model_Yearly_2051to2095_Precipitation_Data); % K
 Japan_Model_2051to2095_Longterm_SD_Precipitation = ...
    mean(China_Model_Yearly_2051to2095_Precipitation_Data); % K
Norway_Model_2051to2095_Longterm_SD_Precipitation = ...
    mean(Norway_Model_Yearly_2051to2095_Precipitation_Data); % K

% Compute Bias Difference 
    % Control Period 1961 to 2005 
China_Model_Bias_diff_P = Observed_1961to2005_Longterm_Mean_Precipitation ...
    - China_Model_1961to2005_Longterm_Mean_Precipitation;
France_Model_Bias_diff_P = Observed_1961to2005_Longterm_Mean_Precipitation ...
    - France_Model_1961to2005_Longterm_Mean_Precipitation;
Russia_Model_Bias_diff_P = Observed_1961to2005_Longterm_Mean_Precipitation ...
    - Russia_Model_1961to2005_Longterm_Mean_Precipitation;
Japan_Model_Bias_diff_P = Observed_1961to2005_Longterm_Mean_Precipitation ...
    - Japan_Model_1961to2005_Longterm_Mean_Precipitation;
Norway_Model_Bias_diff_P = Observed_1961to2005_Longterm_Mean_Precipitation ...
    - Norway_Model_1961to2005_Longterm_Mean_Precipitation;

% Compute Comparitive Bias Ratio 
    % Control Period 1961 to 2005
China_Model_Bias_ratio_P = Observed_1961to2005_Longterm_Mean_Precipitation ...
    / China_Model_1961to2005_Longterm_Mean_Precipitation;
France_Model_Bias_ratio_P = Observed_1961to2005_Longterm_Mean_Precipitation ...
    / France_Model_1961to2005_Longterm_Mean_Precipitation;
Russia_Model_Bias_ratio_P = Observed_1961to2005_Longterm_Mean_Precipitation ...
    / Russia_Model_1961to2005_Longterm_Mean_Precipitation;
Japan_Model_Bias_ratio_P = Observed_1961to2005_Longterm_Mean_Precipitation ...
    / Japan_Model_1961to2005_Longterm_Mean_Precipitation;
Norway_Model_Bias_ratio_P = Observed_1961to2005_Longterm_Mean_Precipitation ...
    / Norway_Model_1961to2005_Longterm_Mean_Precipitation;

% Compute the the temperture anomaly series, 
for t = 1:45
    % Control Period 1961 to 2005
    China_Model_1961to2005_Precipitation_Anomaly_Series(t) = ...
        (China_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - China_Model_1961to2005_Longterm_Mean_Precipitation) ...
         / China_Model_1961to2005_Longterm_SD_Precipitation;
    France_Model_1961to2005_Precipitation_Anomaly_Series(t) = ...
        (France_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - France_Model_1961to2005_Longterm_Mean_Precipitation) ...
         / France_Model_1961to2005_Longterm_SD_Precipitation;
    Russia_Model_1961to2005_Precipitation_Anomaly_Series(t) = ...
        (Russia_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - Russia_Model_1961to2005_Longterm_Mean_Precipitation) ...
         / Russia_Model_1961to2005_Longterm_SD_Precipitation;
    Japan_Model_1961to2005_Precipitation_Anomaly_Series(t) = ...
        (Japan_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - Japan_Model_1961to2005_Longterm_Mean_Precipitation) ...
         / Japan_Model_1961to2005_Longterm_SD_Precipitation;
    Norway_Model_1961to2005_Precipitation_Anomaly_Series(t) = ...
        (Norway_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - Norway_Model_1961to2005_Longterm_Mean_Precipitation) ...
         / Norway_Model_1961to2005_Longterm_SD_Precipitation;
    
    % Future 2006 to 2050
    China_Model_2006to2050_Precipitation_Anomaly_Series(t) = ...
        (China_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - China_Model_2006to2050_Longterm_Mean_Precipitation) ...
         / China_Model_2006to2050_Longterm_SD_Precipitation;
    France_Model_2006to2050_Precipitation_Anomaly_Series(t) = ...
        (France_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - France_Model_2006to2050_Longterm_Mean_Precipitation) ...
         / France_Model_2006to2050_Longterm_SD_Precipitation;
    Russia_Model_2006to2050_Precipitation_Anomaly_Series(t) = ...
        (Russia_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - Russia_Model_2006to2050_Longterm_Mean_Precipitation) ...
         / Russia_Model_2006to2050_Longterm_SD_Precipitation;
    Japan_Model_2006to2050_Precipitation_Anomaly_Series(t) = ...
        (Japan_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - Japan_Model_2006to2050_Longterm_Mean_Precipitation) ...
         / Japan_Model_2006to2050_Longterm_SD_Precipitation;
    Norway_Model_2006to2050_Precipitation_Anomaly_Series(t) = ...
        (Norway_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - Norway_Model_2006to2050_Longterm_Mean_Precipitation) ...
         / Norway_Model_2006to2050_Longterm_SD_Precipitation;
   
    % Future 2051 to 2095
    China_Model_2051to2095_Precipitation_Anomaly_Series(t) = ...
        (China_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - China_Model_2051to2095_Longterm_Mean_Precipitation) ...
         / China_Model_2051to2095_Longterm_SD_Precipitation;
    France_Model_2051to2095_Precipitation_Anomaly_Series(t) = ...
        (France_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - France_Model_2051to2095_Longterm_Mean_Precipitation) ...
         / France_Model_2051to2095_Longterm_SD_Precipitation;
    Russia_Model_2051to2095_Precipitation_Anomaly_Series(t) = ...
        (Russia_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - Russia_Model_2051to2095_Longterm_Mean_Precipitation) ...
         / Russia_Model_2051to2095_Longterm_SD_Precipitation;
    Japan_Model_2051to2095_Precipitation_Anomaly_Series(t) = ...
        (Japan_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - Japan_Model_2051to2095_Longterm_Mean_Precipitation) ...
         / Japan_Model_2051to2095_Longterm_SD_Precipitation;
    Norway_Model_2051to2095_Precipitation_Anomaly_Series(t) = ...
        (Norway_Model_Yearly_2051to2095_Precipitation_Data(t) ...
        - Norway_Model_2051to2095_Longterm_Mean_Precipitation) ...
         / Norway_Model_2051to2095_Longterm_SD_Precipitation;
end

% Compute Bias-corrected Teperture series     
for t = 1:45
    % Control Period 1961 to 2005
    if (China_Model_Bias_diff_P <= -1e-3 || China_Model_Bias_diff_P >= 1e-3) ...
        && (China_Model_Bias_ratio_P <= 0.999 || China_Model_Bias_ratio_P >= 1.001)
        China_Model_1961to2005_Precipitation_Bias_Corrected(t) = ...
            China_Model_1961to2005_Precipitation_Anomaly_Series(t) ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            + Observed_1961to2005_Longterm_Mean_Precipitation;
    else
        China_Model_1961to2005_Precipitation_Bias_Corrected(t) = 0;
    end
    if (France_Model_Bias_diff_P <= -1e-3 || France_Model_Bias_diff_P >= 1e-3) ...
        && (France_Model_Bias_ratio_P <= 0.999 || France_Model_Bias_ratio_P >= 1.001)
        France_Model_1961to2005_Precipitation_Bias_Corrected(t) = ...
            France_Model_1961to2005_Precipitation_Anomaly_Series(t) ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            + Observed_1961to2005_Longterm_Mean_Precipitation;
    else
        France_Model_1961to2005_Precipitation_Bias_Corrected(t) = 0;
    end
    if (Russia_Model_Bias_diff_P <= -1e-3 || Russia_Model_Bias_diff_P >= 1e-3) ...
        && (Russia_Model_Bias_ratio_P <= 0.999 || Russia_Model_Bias_ratio_P >= 1.001)
        Russia_Model_1961to2005_Precipitation_Bias_Corrected(t) = ...
            Russia_Model_1961to2005_Precipitation_Anomaly_Series(t) ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            + Observed_1961to2005_Longterm_Mean_Precipitation;
    else
        Russia_Model_1961to2005_Precipitation_Bias_Corrected(t) = 0;
    end
    if (Japan_Model_Bias_diff_P <= -1e-3 || Japan_Model_Bias_diff_P >= 1e-3) ...
        && (Japan_Model_Bias_ratio_P <= 0.999 || Japan_Model_Bias_ratio_P >= 1.001)
        Japan_Model_1961to2005_Precipitation_Bias_Corrected(t) = ...
            Japan_Model_1961to2005_Precipitation_Anomaly_Series(t) ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            + Observed_1961to2005_Longterm_Mean_Precipitation;
    else
        Japan_Model_1961to2005_Precipitation_Bias_Corrected(t) = 0;
    end
    if (Norway_Model_Bias_diff_P <= -1e-3 || Norway_Model_Bias_diff_P >= 1e-3) ...
        && (Norway_Model_Bias_ratio_P <= 0.999 || Norway_Model_Bias_ratio_P >= 1.001)
        Norway_Model_1961to2005_Precipitation_Bias_Corrected(t) = ...
            Norway_Model_1961to2005_Precipitation_Anomaly_Series(t) ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            + Observed_1961to2005_Longterm_Mean_Precipitation;
    else
        Norway_Model_1961to2005_Precipitation_Bias_Corrected(t) = 0;
    end

    % Future 2006 to 2050
    if (China_Model_Bias_diff_P <= -1e-3 || China_Model_Bias_diff_P >= 1e-3) ...
        && (China_Model_Bias_ratio_P <= 0.999 || China_Model_Bias_ratio_P >= 1.001)
        China_Model_2006to2050_Precipitation_Bias_Corrected(t) = ...
            China_Model_2006to2050_Precipitation_Anomaly_Series(t) ...
            * China_Model_2006to2050_Longterm_SD_Precipitation ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            / China_Model_1961to2005_Longterm_SD_Precipitation ...
            + China_Model_2006to2050_Longterm_Mean_Precipitation ... 
            + (Observed_1961to2005_Longterm_Mean_Precipitation ...
            - China_Model_2006to2050_Longterm_Mean_Precipitation);
    else
        China_Model_2006to2050_Precipitation_Bias_Corrected(t) = 0;
    end
    if (France_Model_Bias_diff_P <= -1e-3 || France_Model_Bias_diff_P >= 1e-3) ...
        && (France_Model_Bias_ratio_P <= 0.999 || France_Model_Bias_ratio_P >= 1.001)
        France_Model_2006to2050_Precipitation_Bias_Corrected(t) = ...
            France_Model_2006to2050_Precipitation_Anomaly_Series(t) ...
            * France_Model_2006to2050_Longterm_SD_Precipitation ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            / France_Model_1961to2005_Longterm_SD_Precipitation ...
            + France_Model_2006to2050_Longterm_Mean_Precipitation ... 
            + (Observed_1961to2005_Longterm_Mean_Precipitation ...
            - France_Model_2006to2050_Longterm_Mean_Precipitation);
    else
        France_Model_2006to2050_Precipitation_Bias_Corrected(t) = 0;
    end
    if (Russia_Model_Bias_diff_P <= -1e-3 || Russia_Model_Bias_diff_P >= 1e-3) ...
        && (Russia_Model_Bias_ratio_P <= 0.999 || Russia_Model_Bias_ratio_P >= 1.001)
        Russia_Model_2006to2050_Precipitation_Bias_Corrected(t) = ...
            Russia_Model_2006to2050_Precipitation_Anomaly_Series(t) ...
            * Russia_Model_2006to2050_Longterm_SD_Precipitation ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            / Russia_Model_1961to2005_Longterm_SD_Precipitation ...
            + Russia_Model_2006to2050_Longterm_Mean_Precipitation ... 
            + (Observed_1961to2005_Longterm_Mean_Precipitation ...
            - Russia_Model_2006to2050_Longterm_Mean_Precipitation);
    else
        Russia_Model_2006to2050_Precipitation_Bias_Corrected(t) = 0;
    end
    if (Japan_Model_Bias_diff_P <= -1e-3 || Japan_Model_Bias_diff_P >= 1e-3) ...
        && (Japan_Model_Bias_ratio_P <= 0.999 || Japan_Model_Bias_ratio_P >= 1.001)
        Japan_Model_2006to2050_Precipitation_Bias_Corrected(t) = ...
            Japan_Model_2006to2050_Precipitation_Anomaly_Series(t) ...
            * Japan_Model_2006to2050_Longterm_SD_Precipitation ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            / Japan_Model_1961to2005_Longterm_SD_Precipitation ...
            + Japan_Model_2006to2050_Longterm_Mean_Precipitation ... 
            + (Observed_1961to2005_Longterm_Mean_Precipitation ...
            - Japan_Model_2006to2050_Longterm_Mean_Precipitation);
    else
        Japan_Model_2006to2050_Precipitation_Bias_Corrected(t) = 0;
    end
    if (Norway_Model_Bias_diff_P <= -1e-3 || Norway_Model_Bias_diff_P >= 1e-3) ...
        && (Norway_Model_Bias_ratio_P <= 0.999 || Norway_Model_Bias_ratio_P >= 1.001)
        Norway_Model_2006to2050_Precipitation_Bias_Corrected(t) = ...
            Norway_Model_2006to2050_Precipitation_Anomaly_Series(t) ...
            * Norway_Model_2006to2050_Longterm_SD_Precipitation ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            / Norway_Model_1961to2005_Longterm_SD_Precipitation ...
            + Norway_Model_2006to2050_Longterm_Mean_Precipitation ... 
            + (Observed_1961to2005_Longterm_Mean_Precipitation ...
            - Norway_Model_2006to2050_Longterm_Mean_Precipitation);
    else
        Norway_Model_2006to2050_Precipitation_Bias_Corrected(t) = 0;
    end  
    % Future 2051 to 2095
    if (China_Model_Bias_diff_P <= -1e-3 || China_Model_Bias_diff_P >= 1e-3) ...
        && (China_Model_Bias_ratio_P <= 0.999 || China_Model_Bias_ratio_P >= 1.001)
        China_Model_2051to2095_Precipitation_Bias_Corrected(t) = ...
            China_Model_2051to2095_Precipitation_Anomaly_Series(t) ...
            * China_Model_2051to2095_Longterm_SD_Precipitation ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            / China_Model_1961to2005_Longterm_SD_Precipitation ...
            + China_Model_2051to2095_Longterm_Mean_Precipitation ... 
            + (Observed_1961to2005_Longterm_Mean_Precipitation ...
            - China_Model_2051to2095_Longterm_Mean_Precipitation);
    else
        China_Model_2051to2095_Precipitation_Bias_Corrected(t) = 0;
    end
    if (France_Model_Bias_diff_P <= -1e-3 || France_Model_Bias_diff_P >= 1e-3) ...
        && (France_Model_Bias_ratio_P <= 0.999 || France_Model_Bias_ratio_P >= 1.001)
        France_Model_2051to2095_Precipitation_Bias_Corrected(t) = ...
            France_Model_2051to2095_Precipitation_Anomaly_Series(t) ...
            * France_Model_2051to2095_Longterm_SD_Precipitation ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            / France_Model_1961to2005_Longterm_SD_Precipitation ...
            + France_Model_2051to2095_Longterm_Mean_Precipitation ... 
            + (Observed_1961to2005_Longterm_Mean_Precipitation ...
            - France_Model_2051to2095_Longterm_Mean_Precipitation);
    else
        France_Model_2051to2095_Precipitation_Bias_Corrected(t) = 0;
    end
    if (Russia_Model_Bias_diff_P <= -1e-3 || Russia_Model_Bias_diff_P >= 1e-3) ...
        && (Russia_Model_Bias_ratio_P <= 0.999 || Russia_Model_Bias_ratio_P >= 1.001)
        Russia_Model_2051to2095_Precipitation_Bias_Corrected(t) = ...
            Russia_Model_2051to2095_Precipitation_Anomaly_Series(t) ...
            * Russia_Model_2051to2095_Longterm_SD_Precipitation ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            / Russia_Model_1961to2005_Longterm_SD_Precipitation ...
            + Russia_Model_2051to2095_Longterm_Mean_Precipitation ... 
            + (Observed_1961to2005_Longterm_Mean_Precipitation ...
            - Russia_Model_2051to2095_Longterm_Mean_Precipitation);
    else
        Russia_Model_2051to2095_Precipitation_Bias_Corrected(t) = 0;
    end
    if (Japan_Model_Bias_diff_P <= -1e-3 || Japan_Model_Bias_diff_P >= 1e-3) ...
        && (Japan_Model_Bias_ratio_P <= 0.999 || Japan_Model_Bias_ratio_P >= 1.001)
        Japan_Model_2051to2095_Precipitation_Bias_Corrected(t) = ...
            Japan_Model_2051to2095_Precipitation_Anomaly_Series(t) ...
            * Japan_Model_2051to2095_Longterm_SD_Precipitation ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            / Japan_Model_1961to2005_Longterm_SD_Precipitation ...
            + Japan_Model_2051to2095_Longterm_Mean_Precipitation ... 
            + (Observed_1961to2005_Longterm_Mean_Precipitation ...
            - Japan_Model_2051to2095_Longterm_Mean_Precipitation);
    else
        Japan_Model_2051to2095_Precipitation_Bias_Corrected(t) = 0;
    end
    if (Norway_Model_Bias_diff_P <= -1e-3 || Norway_Model_Bias_diff_P >= 1e-3) ...
        && (Norway_Model_Bias_ratio_P <= 0.999 || Norway_Model_Bias_ratio_P >= 1.001)
        Norway_Model_2051to2095_Precipitation_Bias_Corrected(t) = ...
            Norway_Model_2051to2095_Precipitation_Anomaly_Series(t) ...
            * Norway_Model_2051to2095_Longterm_SD_Precipitation ...
            * Observed_1961to2005_Longterm_SD_Precipitation ...
            / Norway_Model_1961to2005_Longterm_SD_Precipitation ...
            + Norway_Model_2051to2095_Longterm_Mean_Precipitation ... 
            + (Observed_1961to2005_Longterm_Mean_Precipitation ...
            - Norway_Model_2051to2095_Longterm_Mean_Precipitation);
    else
        Norway_Model_2051to2095_Precipitation_Bias_Corrected(t) = 0;
    end
end

%% Figures for Observed vs. Model Bias Corrected Data

% Define the time periods
years_1961_2005 = 1961:2005;
years_2006_2050 = 2006:2050;
years_2051_2095 = 2051:2095;

% (1) Observed vs. Bias Corrected Mean Temperature (1961-2005)
figure;
plot(years_1961_2005, Observed_Yearly_1961to2005_Mean_Temperature_Data, 'k-', 'LineWidth', 1.5); hold on;
plot(years_1961_2005, China_Model_1961to2005_Temperature_Bias_Corrected, 'r--', 'LineWidth', 1.5);
plot(years_1961_2005, France_Model_1961to2005_Temperature_Bias_Corrected, 'g--', 'LineWidth', 1.5);
plot(years_1961_2005, Russia_Model_1961to2005_Temperature_Bias_Corrected, 'b--', 'LineWidth', 1.5);
plot(years_1961_2005, Japan_Model_1961to2005_Temperature_Bias_Corrected, 'm--', 'LineWidth', 1.5);
plot(years_1961_2005, Norway_Model_1961to2005_Temperature_Bias_Corrected, 'c--', 'LineWidth', 1.5);
hold off;
legend('Observed', 'China', 'France', 'Russia', 'Japan', 'Norway');
xlabel('Year'); ylabel('Mean Temperature (K)');
title('Observed vs. Bias Corrected Mean Temperature (1961-2005)');
grid on;

% (2) Bias Corrected Mean Temperature (2006-2050)
figure;
plot(years_2006_2050, China_Model_2006to2050_Temperature_Bias_Corrected, 'r--', 'LineWidth', 1.5); hold on;
plot(years_2006_2050, France_Model_2006to2050_Temperature_Bias_Corrected, 'g--', 'LineWidth', 1.5);
plot(years_2006_2050, Russia_Model_2006to2050_Temperature_Bias_Corrected, 'b--', 'LineWidth', 1.5);
plot(years_2006_2050, Japan_Model_2006to2050_Temperature_Bias_Corrected, 'm--', 'LineWidth', 1.5);
plot(years_2006_2050, Norway_Model_2006to2050_Temperature_Bias_Corrected, 'c--', 'LineWidth', 1.5);
hold off;
legend('China', 'France', 'Russia', 'Japan', 'Norway');
xlabel('Year'); ylabel('Mean Temperature (K)');
title('Bias Corrected Mean Temperature (2006-2050)');
grid on;

% (3) Bias Corrected Mean Temperature (2051-2095)
figure;
plot(years_2051_2095, China_Model_2051to2095_Temperature_Bias_Corrected, 'r--', 'LineWidth', 1.5); hold on;
plot(years_2051_2095, France_Model_2051to2095_Temperature_Bias_Corrected, 'g--', 'LineWidth', 1.5);
plot(years_2051_2095, Russia_Model_2051to2095_Temperature_Bias_Corrected, 'b--', 'LineWidth', 1.5);
plot(years_2051_2095, Japan_Model_2051to2095_Temperature_Bias_Corrected, 'm--', 'LineWidth', 1.5);
plot(years_2051_2095, Norway_Model_2051to2095_Temperature_Bias_Corrected, 'c--', 'LineWidth', 1.5);
hold off;
legend('China', 'France', 'Russia', 'Japan', 'Norway');
xlabel('Year'); ylabel('Mean Temperature (K)');
title('Bias Corrected Mean Temperature (2051-2095)');
grid on;

% (4) Observed vs. Bias Corrected Precipitation (1961-2005)
figure;
plot(years_1961_2005, Observed_Yearly_1961to2005_Precipitation_Data, 'k-', 'LineWidth', 1.5); hold on;
plot(years_1961_2005, China_Model_1961to2005_Precipitation_Bias_Corrected, 'r--', 'LineWidth', 1.5);
plot(years_1961_2005, France_Model_1961to2005_Precipitation_Bias_Corrected, 'g--', 'LineWidth', 1.5);
plot(years_1961_2005, Russia_Model_1961to2005_Precipitation_Bias_Corrected, 'b--', 'LineWidth', 1.5);
plot(years_1961_2005, Japan_Model_1961to2005_Precipitation_Bias_Corrected, 'm--', 'LineWidth', 1.5);
plot(years_1961_2005, Norway_Model_1961to2005_Precipitation_Bias_Corrected, 'c--', 'LineWidth', 1.5);
hold off;
legend('Observed', 'China', 'France', 'Russia', 'Japan', 'Norway');
xlabel('Year'); ylabel('Precipitation (mm)');
title('Observed vs. Bias Corrected Precipitation (1961-2005)');
grid on;

% (5) Bias Corrected Precipitation (2006-2050)
figure;
plot(years_2006_2050, China_Model_2006to2050_Precipitation_Bias_Corrected, 'r--', 'LineWidth', 1.5); hold on;
plot(years_2006_2050, France_Model_2006to2050_Precipitation_Bias_Corrected, 'g--', 'LineWidth', 1.5);
plot(years_2006_2050, Russia_Model_2006to2050_Precipitation_Bias_Corrected, 'b--', 'LineWidth', 1.5);
plot(years_2006_2050, Japan_Model_2006to2050_Precipitation_Bias_Corrected, 'm--', 'LineWidth', 1.5);
plot(years_2006_2050, Norway_Model_2006to2050_Precipitation_Bias_Corrected, 'c--', 'LineWidth', 1.5);
hold off;
legend('China', 'France', 'Russia', 'Japan', 'Norway');
xlabel('Year'); ylabel('Precipitation (mm)');
title('Bias Corrected Precipitation (2006-2050)');
grid on;

% (6) Bias Corrected Precipitation (2051-2095)
figure;
plot(years_2051_2095, China_Model_2051to2095_Precipitation_Bias_Corrected, 'r--', 'LineWidth', 1.5); hold on;
plot(years_2051_2095, France_Model_2051to2095_Precipitation_Bias_Corrected, 'g--', 'LineWidth', 1.5);
plot(years_2051_2095, Russia_Model_2051to2095_Precipitation_Bias_Corrected, 'b--', 'LineWidth', 1.5);
plot(years_2051_2095, Japan_Model_2051to2095_Precipitation_Bias_Corrected, 'm--', 'LineWidth', 1.5);
plot(years_2051_2095, Norway_Model_2051to2095_Precipitation_Bias_Corrected, 'c--', 'LineWidth', 1.5);
hold off;
legend('China', 'France', 'Russia', 'Japan', 'Norway');
xlabel('Year'); ylabel('Precipitation (mm)');
title('Bias Corrected Precipitation (2051-2095)');
grid on;












